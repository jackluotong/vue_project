<html>
  <button onclick="test()">click</button>
<script>
  function test(){
    console.log('script start');

setTimeout(function() {
  console.log('setTimeout');
}, 0);

Promise.resolve().then(function() {
  console.log('promise1');
}).then(function() {
  console.log('promise2');
});

console.log('script end');
 
    setTimeout(()=>{
        new Promise(resolve =>{
            resolve();
        }).then(()=>{
            console.log('test');
        });

        console.log(4);
    });

    new Promise(resolve => {
        resolve();
        console.log(1)
    }).then( () => {
        console.log(3);
        Promise.resolve().then(() => {
            console.log('before timeout');
        }).then(() => {
            Promise.resolve().then(() => {
                console.log('also before timeout')
            })
        })
    })
    console.log(2);
  }
    //1 3 4
</script>
</html>